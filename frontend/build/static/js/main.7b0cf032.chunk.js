(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n.p+"static/media/sign-successful.447dd815.svg"},13:function(e,t,n){e.exports=n.p+"static/media/sign-unsuccessful.4072126c.svg"},16:function(e,t,n){e.exports=n(86)},25:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(8),o=n.n(c),i=(n(25),n(14)),l=n(2),s=n(9),u=n.n(s),m=n(0),p=n(4);var d=function(e){var t=e.userEmail,n=e.handleLogout;return r.a.createElement("header",{className:"header"},r.a.createElement("a",{href:"#",className:"header__link"},r.a.createElement("img",{src:u.a,alt:"\u043b\u043e\u0433\u043e",className:"header__logo"})),r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"/sign-up",element:r.a.createElement(p.b,{to:"/sign-in",className:"header__newlink"},"\u0412\u043e\u0439\u0442\u0438")}),r.a.createElement(m.b,{exact:!0,path:"/sign-in",element:r.a.createElement(p.b,{to:"/sign-up",className:"header__newlink"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")}),r.a.createElement(m.b,{exact:!0,path:"/",element:r.a.createElement("div",{className:"header__info"},r.a.createElement("p",{className:"header__email"},t),r.a.createElement(p.b,{onClick:n,to:"/sign-in",className:"header__newlink"},"\u0412\u044b\u0439\u0442\u0438"))})))},f=r.a.createContext();var _=function(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,c=e.onCardDelete,o=r.a.useContext(f),i=t.owner===o._id,l=t.likes.some(function(e){return e===o._id}),s="element__delete-button ".concat(i?"element__delete-button_active":"element__delete-button"),u="element__like-button ".concat(l?"element__like-button_active":"element__like-button");return r.a.createElement("div",{className:"element"},r.a.createElement("img",{alt:t.name,src:t.link,className:"element__image",onClick:function(){n(t)}}),r.a.createElement("button",{type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){c(t)},className:s}),r.a.createElement("div",{className:"element__caption"},r.a.createElement("h2",{className:"element__paragraph"},t.name),r.a.createElement("div",{className:"element__info"},r.a.createElement("button",{type:"button",onClick:function(){a(t)},"aria-label":"\u041b\u0430\u0439\u043a",className:u}),r.a.createElement("p",{className:"element__like-counter"},t.likes.length))))};var h=function(e){var t=e.onEditAvatar,n=e.onEditProfile,a=e.onAddPlace,c=e.cards,o=e.onCardClick,i=e.onCardLike,l=e.onCardDelete,s=r.a.useContext(f),u=c.map(function(e){return r.a.createElement(_,{key:e._id,card:e,onCardClick:o,onCardLike:i,onCardDelete:l})});return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__content"},r.a.createElement("div",{className:"profile__wrap",onClick:t},r.a.createElement("img",{src:s.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar"})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("h1",{className:"profile__name"},s.name),r.a.createElement("button",{onClick:n,type:"button","aria-label":"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",className:"profile__edit-button"}),r.a.createElement("p",{className:"profile__profession"},s.about))),r.a.createElement("button",{onClick:a,type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",className:"profile__add-button"})),r.a.createElement("section",{className:"elements"},u))};var E=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9",(new Date).getFullYear()," Mesto Russia"))},g=function(e){var t=e.isOpen,n=e.name,c=e.onClose,o=e.children,i=e.type;Object(a.useEffect)(function(){if(t){var e=function(e){"Escape"===e.key&&c()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}},[t,c]);return r.a.createElement("div",{className:"popup ".concat(t?"popup_opened":""," popup_type_").concat(n),onClick:function(e){e.target===e.currentTarget&&c()}},r.a.createElement("div",{className:"popup__container popup__container_type_".concat(i)},o,r.a.createElement("button",{className:"popup__close-button",type:"button",onClick:c})))};var b=function(e){var t=e.card,n=e.onClose,a=e.isOpen;return r.a.createElement(g,{onClose:n,isOpen:a,type:"image"},r.a.createElement("img",{alt:t&&t.name,src:t&&t.link,className:"popup__image"}),r.a.createElement("h2",{className:"popup__caption"},t&&t.name))},v=n(10),O=n(11),N=new(function(){function e(t){Object(v.a)(this,e),this._url=t.url,this._headers=t.headers}return Object(O.a)(e,[{key:"_handleRes",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getAllCards",value:function(){var e=this;return fetch("".concat(this._url,"cards"),{method:"GET",credentials:"include",headers:this._headers}).then(function(t){return e._handleRes(t)})}},{key:"handleUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"users/me"),{method:"GET",credentials:"include",headers:this._headers}).then(function(t){return e._handleRes(t)})}},{key:"changeUserInfo",value:function(e,t){var n=this;return fetch("".concat(this._url,"users/me"),{method:"PATCH",credentials:"include",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(function(e){return n._handleRes(e)})}},{key:"addNewCard",value:function(e,t){var n=this;return fetch("".concat(this._url,"cards"),{method:"POST",credentials:"include",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(function(e){return n._handleRes(e)})}},{key:"changeUserAvatar",value:function(e){var t=this;return fetch("".concat(this._url,"users/me/avatar"),{method:"PATCH",credentials:"include",headers:this._headers,body:JSON.stringify({avatar:e})}).then(function(e){return t._handleRes(e)})}},{key:"changeLikeCardStatus",value:function(e,t){var n=this;return fetch("".concat(this._url,"cards/").concat(e,"/likes"),{method:t?"PUT":"DELETE",credentials:"include",headers:this._headers}).then(function(e){return n._handleRes(e)})}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards/").concat(e),{method:"DELETE",credentials:"include",headers:this._headers}).then(function(e){return t._handleRes(e)})}}]),e}())({url:"https://api.mestoproject.nomoredomains.icu/",headers:{"Content-Type":"application/json",Accept:"application/json",authorization:"Bearer ".concat(localStorage.getItem("jwt"))}});var C=function(e){var t=e.name,n=e.isOpen,a=e.title,c=e.onSubmit,o=e.children,i=e.buttonText,l=e.onClose;return r.a.createElement(g,{isOpen:n,name:t,onClose:l,type:"form"},r.a.createElement("h2",{className:"popup__title"},a),r.a.createElement("form",{className:"popup__form",onSubmit:c,name:t},o,r.a.createElement("button",{className:"popup__save",type:"submit"},i)))};function j(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,o=Object(a.useState)(""),i=Object(l.a)(o,2),s=i[0],u=i[1],m=Object(a.useState)(""),p=Object(l.a)(m,2),d=p[0],_=p[1],h=r.a.useContext(f);return Object(a.useEffect)(function(){u(h.name),_(h.about)},[h,t]),r.a.createElement(C,{isOpen:t,onClose:n,name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(e){e.preventDefault(),c({name:s,about:d})}},r.a.createElement("input",{id:"name-input",value:s||"",onChange:function(e){u(e.target.value)},className:"popup__input popup__input_type_name",type:"text",minLength:"2",maxLength:"40",required:!0,name:"userName",placeholder:"\u0418\u043c\u044f"}),r.a.createElement("span",{className:"popup__input-error name-input-error"}),r.a.createElement("input",{id:"profession-input",value:d||"",onChange:function(e){_(e.target.value)},className:"popup__input popup__input_type_profession",type:"text",minLength:"2",maxLength:"200",required:!0,name:"userInfo",placeholder:"\u041e \u0441\u0435\u0431\u0435"}),r.a.createElement("span",{className:"popup__input-error profession-input-error"}))}function k(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,c=r.a.useRef();return r.a.createElement(C,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:c.current.value})}},r.a.createElement("input",{id:"avatar-input",ref:c,className:"popup__input popup__input_type_avatar",type:"url",required:!0,name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440"}),r.a.createElement("span",{className:"popup__input-error avatar-input-error"}))}function y(e){var t=e.onAddPlace,n=e.isOpen,c=e.onClose,o=Object(a.useState)(""),i=Object(l.a)(o,2),s=i[0],u=i[1],m=Object(a.useState)(""),p=Object(l.a)(m,2),d=p[0],f=p[1];return Object(a.useEffect)(function(){u(""),f("")},[n]),r.a.createElement(C,{isOpen:n,onClose:c,onSubmit:function(e){e.preventDefault(),t(s,d)},name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"},r.a.createElement("input",{id:"title-input",onChange:function(e){u(e.target.value)},value:s,className:"popup__input popup__input_type_title",type:"text",minLength:"2",maxLength:"30",required:!0,name:"title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),r.a.createElement("span",{className:"popup__input-error title-input-error"}),r.a.createElement("input",{id:"link-input",onChange:function(e){f(e.target.value)},value:d,className:"popup__input popup__input_type_link",type:"url",required:!0,name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"}),r.a.createElement("span",{className:"popup__input-error link-input-error"}))}var S=n(5),w=n(6);var x=function(e){var t=e.handleRegister,n=Object(a.useState)({password:"",email:""}),c=Object(l.a)(n,2),o=c[0],i=c[1],s=function(e){var t=e.target,n=t.name,a=t.value;i(function(e){return Object(w.a)({},e,Object(S.a)({},n,a))})};return r.a.createElement("div",{className:"register"},r.a.createElement("p",{className:"register__welcome"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=o.password,a=o.email;t(n,a)},className:"register__form"},r.a.createElement("input",{className:"register__input",placeholder:"Email",id:"email",name:"email",type:"email",value:o.email,onChange:s}),r.a.createElement("input",{className:"register__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password",name:"password",type:"password",value:o.password,onChange:s}),r.a.createElement("button",{type:"submit",className:"register__link"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement("div",{className:"register__info"},r.a.createElement("p",{className:"register__signin"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"),r.a.createElement(p.b,{to:"/sign-in",className:"register__signin-link"},"\u0412\u043e\u0439\u0442\u0438")))};var T=function(e){var t=e.handleLogin,n=Object(a.useState)({password:"",email:""}),c=Object(l.a)(n,2),o=c[0],i=c[1],s=function(e){var t=e.target,n=t.name,a=t.value;i(function(e){return Object(w.a)({},e,Object(S.a)({},n,a))})};return r.a.createElement("div",{className:"register"},r.a.createElement("p",{className:"register__welcome"},"\u0412\u0445\u043e\u0434"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=o.password,a=o.email;t(n,a)},className:"register__form"},r.a.createElement("input",{className:"register__input",placeholder:"Email",id:"email",name:"email",type:"email",value:o.email,onChange:s}),r.a.createElement("input",{className:"register__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password",name:"password",type:"password",value:o.password,onChange:s}),r.a.createElement("button",{type:"submit",className:"register__link"},"\u0412\u043e\u0439\u0442\u0438")))},L=n(15),P=function(e){var t=e.component,n=Object(L.a)(e,["component"]);return n.loggedIn?r.a.createElement(t,n):r.a.createElement(m.a,{to:"/sign-in"})},A="https://api.mestoproject.nomoredomains.icu",I=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},D=function(e,t){return fetch("".concat(A,"/signup"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(I)},R=function(e,t){return fetch("".concat(A,"/signin"),{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(I)},U=function(e){return fetch("".concat(A,"/users/me"),{method:"GET",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json",authorization:"Bearer ".concat(e)}}).then(I)},J=n(12),F=n.n(J),q=n(13),B=n.n(q);var G=function(e){var t=e.isOpen,n=e.onClose,a=e.signupImage,c=e.signupText;return r.a.createElement(g,{onClose:n,isOpen:t,type:"form"},r.a.createElement("img",{src:a,className:"popup__img",alt:""}),r.a.createElement("h2",{className:"popup__text"},c))};var z=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),s=Object(l.a)(o,2),u=s[0],p=s[1],_=Object(a.useState)(!1),g=Object(l.a)(_,2),v=g[0],O=g[1],C=Object(a.useState)(null),S=Object(l.a)(C,2),w=S[0],L=S[1],A=Object(a.useState)({}),I=Object(l.a)(A,2),J=I[0],q=I[1],z=Object(a.useState)([]),H=Object(l.a)(z,2),M=H[0],Y=H[1],K=Object(a.useState)(!1),Q=Object(l.a)(K,2),V=Q[0],W=Q[1],X=Object(a.useState)(""),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)(""),ne=Object(l.a)(te,2),ae=ne[0],re=ne[1],ce=Object(a.useState)(""),oe=Object(l.a)(ce,2),ie=oe[0],le=oe[1],se=Object(a.useState)(!1),ue=Object(l.a)(se,2),me=ue[0],pe=ue[1],de=Object(m.g)();function fe(){c(!1),p(!1),O(!1),L(null),pe(!1)}function _e(){pe(!0)}return Object(a.useEffect)(function(){Promise.all([N.getAllCards(),N.handleUserInfo()]).then(function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];Y(n),q(a)}).catch(function(e){return console.log(e)})},[]),Object(a.useEffect)(function(){!function(){var e=localStorage.getItem("jwt");e&&U(e).then(function(e){e&&(W(!0),ee(e.email))}).catch(function(e){return console.log(e)})}()},[]),Object(a.useEffect)(function(){V&&de("/")},[V,de]),r.a.createElement(f.Provider,{value:J},r.a.createElement("div",{className:"page"},r.a.createElement(d,{userEmail:$,handleLogout:function(){localStorage.removeItem("jwt"),ee(""),W(!1)}}),r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/sign-up",element:r.a.createElement(x,{handleRegister:function(e,t){D(e,t).then(function(e){e&&(re(F.a),le("\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"),de("/sign-in"))}).catch(function(){re(B.a),le("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.")}).finally(_e)}})}),r.a.createElement(m.b,{path:"/sign-in",element:r.a.createElement(T,{handleLogin:function(e,t){R(e,t).then(function(e){e&&(localStorage.setItem("jwt",e.token),de("/"),W(!0),ee(t))}).catch(function(e){return console.log(e)})}})}),r.a.createElement(m.b,{exact:!0,path:"/",element:r.a.createElement(r.a.Fragment,null,r.a.createElement(P,{component:h,onEditProfile:function(){c(!0)},onEditAvatar:function(){O(!0)},onAddPlace:function(){p(!0)},onCardClick:function(e){L(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e===J._id});N.changeLikeCardStatus(e._id,!t).then(function(t){Y(function(n){return n.map(function(n){return n._id===e._id?t:n})})}).catch(function(e){return console.log(e)})},onCardDelete:function(e){N.deleteCard(e._id).then(function(){Y(function(t){return t.filter(function(t){return t._id!==e._id})})}).catch(function(e){return console.log(e)})},cards:M,loggedIn:V}),r.a.createElement(E,null))})),r.a.createElement(j,{isOpen:n,onClose:fe,onUpdateUser:function(e){N.changeUserInfo(e.name,e.about).then(function(e){q(e),fe()}).catch(function(e){return console.log(e)})}}),r.a.createElement(y,{isOpen:u,onClose:fe,onAddPlace:function(e,t){N.addNewCard(e,t).then(function(e){Y([e].concat(Object(i.a)(M))),fe()}).catch(function(e){return console.log(e)})}}),r.a.createElement(k,{isOpen:v,onClose:fe,onUpdateAvatar:function(e){N.changeUserAvatar(e.avatar).then(function(e){q(e),fe()}).catch(function(e){return console.log(e)})}}),r.a.createElement(b,{isOpen:w,onClose:fe,card:w}),r.a.createElement(G,{signupImage:ae,signupText:ie,isOpen:me,onClose:fe})))},H=function(e){e&&e instanceof Function&&n.e(1).then(n.bind(null,87)).then(function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)})};o.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(p.a,null,r.a.createElement(z,null)))),H()},9:function(e,t,n){e.exports=n.p+"static/media/logopic.6c98c1b9.svg"}},[[16,3,2]]]);
//# sourceMappingURL=main.7b0cf032.chunk.js.map